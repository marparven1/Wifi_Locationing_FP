---
title: "Análisis exploratorio"
author: "Marta Venegas Pardo"
date: "3/8/2022"
output:
  prettydoc::html_pretty:
    theme: architect
    highlight: github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE , warning = FALSE)
```

```{r}
library(dplyr)
library(kableExtra)
library(ggplot2)
```


```{r}
# remove several unnecessary columns such as User ID, Phone ID and Timestamp.
```




```{r ,  lectura de datos}
load("Data_UJIndoorLoc/TrainingDataCleaned.RData")
dim(TrainingDataCleaned)
```
 




# Análisis descriptivo

Nuestro conjunto de datos tiene las siguientes dimensiones: `r dim(TrainingDataCleaned)`. De las 474 variables, 464 de ellas corresponden al valor de la intensidad de señal que llega al movil desde cada punto de acceso inalámbrico WAP y las otras 10 variables corresponden a posición desde donde se ha tomado la señal e identificación del usuario y teléfono móvil utilizado.


Vamos a mostrar los datos a modo de tabla, pero únicamente mostraremos algunas de las variables WAP, ya que son demasiadas.


```{r}
DT::datatable(TrainingDataCleaned[,-c(7:464)])
```


- Formato de cada variable:


```{r}
TrainingDataCleaned[,-c(1:465)] %>% str()
```






En primer lugar, vamos a hacer un breve análisis descriptivo de las variables que no corresponden a las señales WAP.



```{r}
TrainingDataCleaned[,-c(1:465)] %>% summary()
```



Encontramos 3 edificios y 5 plantas diferentes, pero eso no tiene porque indicar que todos los pisos tengan 5 plantas.



```{r}
TrainingDataCleaned %>% select("FLOOR" | "BUILDINGID") %>% table()
```

En la tabla anterior observamos que el único edificio que tiene 5 plantas es el edificio número 2, y que los edificios 0 y 1 tienen 4 únicamente 5 plantas.




```{r}
ggplot(data=data.frame(
  BUILDINGID = 0:2 , 
  MEDICIONES = colSums(TrainingDataCleaned %>% select("FLOOR" | "BUILDINGID") %>% table())
), aes(x=BUILDINGID, y=MEDICIONES,fill=BUILDINGID)) + 
    geom_bar(stat="identity", position="stack") # position=position.stack se puede abreviar con position="stack".


```






```{r}
Dat_Infor <- Dat_Entrenamiento[,-c(1:520)]
# Dat_Infor %>% head()
Dat_Infor %>% str()
```


```{r}
colnames(Dat_Infor)
Dat_Infor %>% summary()
```


Número de medidas tomadas por cada usuario:

```{r}
Df <-data.frame(USERID = 1:18,count =  rep(NA,18)) 
for (i in Df[,1]) {
  Df[[i,2]]<-  Dat_Entrenamiento %>% filter(USERID == i ) %>% nrow() 
}
Df 
```
Número de medidas tomadas por cada teléfono:

```{r}
Dat_Entrenamiento %>% select(PHONEID ) %>% table()
```


Según la planta:

```{r}
Dat_Entrenamiento %>% select(FLOOR) %>% table()

```


Por edificio:

```{r}
Dat_Entrenamiento %>% select(BUILDINGID) %>% table()
```

Claramente en el edificio 2 se han tomado una cantidad de señales superior al resto de edificios.


```{r}
Dat_Entrenamiento %>% select(SPACEID) %>% table()
```

Según la posición relativa:


```{r}
Dat_Entrenamiento %>% select(RELATIVEPOSITION) %>% table()
```



```{r}

# Si para una medición todas las intensidades son la misma, eso indicaría que no tengo cobertura # en ningún WAP, y por tanto esos registros los eliminaremos, ya que no nos aportan información # ninguna.
# 
# Si la varianza es 0, eso indica que es constante.


# Registros con varianza = 0 
Var0 <- which ( apply(Dat_Entrenamiento[,1:520], 1, var) == 0 ) # índice del registro donde VAR es 0 

Dat_EntrenamientoII <- Dat_Entrenamiento[-Var0 ,]
```